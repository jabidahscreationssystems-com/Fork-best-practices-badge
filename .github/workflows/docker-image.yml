name: Docker Image CI

# Limit permissions per project security standards
permissions:
  contents: read

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - name: Harden Runner
      uses: step-security/harden-runner@95d9a5deda9de15063e7595e9719c11c38c90ae2 # pin @v2.13.2
      with:
        egress-policy: audit

    - uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # pin @v4.1

    # OSPS-BR-01.02: Validate branch name before use in pipeline
    # This protects against potential future use of branch names in commands
    # GITHUB_REF_NAME is the short ref name (e.g., "main" not "refs/heads/main")
    - name: Validate branch name
      run: script/validate_branch_name "$GITHUB_REF_NAME"

    - name: Build the Docker image
      run: docker build . --file dockerfiles/3.4.1-browsers/Dockerfile
